---
title: "2 nicheROVER - Niche Overlap Analysis"
author: "Zhehao Hu"
data: 2024-06-20
output: pdf_document
---

A new probabilistic method for quantifing n-dimensional ecological niche and niche overlap. See [publication](https://esajournals.onlinelibrary.wiley.com/doi/10.1890/14-0235.1).

# Script "nicheROVER.R"

This script requires the package "nicheROVER", it can be installed directly from CRAN. See also the [program guide](https://cran.r-project.org/web/packages/nicheROVER/vignettes/ecol-vignette.html).

```{r setup, include=FALSE}
if (!require("nicheROVER")) install.packages("nicheROVER")
library(nicheROVER)
```

"Fish" is a **fish stable isotope dataset** integrated in the package, containing values for three stable isotopes (N-15, C-13, S-34) measured in the muscle tissue of four species of arctic fish (ARCS, BDWF, LKWF, LSCS). Use `?fish` or `?nicheROVER::fish` for more details. 

```{r} 
data(fish)
head(fish)
```

A brief view into the mean of isotope for each species.

```{r}
aggregate(fish[2:4], fish[1], mean)
```

## Using `niw.post()` to draw random simulation data points. 

```{r}
# generate parameter draws from the "default" posteriors of each species
nsamples <- 1000
fish.par <- tapply(1:nrow(fish), fish$species,
            function(ii) niw.post(nsamples = nsamples, X = fish[ii,2:4]))
str(fish.par) # take a look into data structure
```

## Plot niche parameters

```{r}
# various parameter plots
clrs <- c("black", "red", "blue", "orange") # colors for each species

# mu1 (del15N), mu2 (del13C), and Sigma12  
par(mar = c(4, 4, .5, .1)+.1, mfrow = c(1,3))
niche.par.plot(fish.par, col = clrs, plot.index = 1)
niche.par.plot(fish.par, col = clrs, plot.index = 2)
niche.par.plot(fish.par, col = clrs, plot.index = 1:2)
legend("topleft", legend = names(fish.par), fill = clrs)
```

